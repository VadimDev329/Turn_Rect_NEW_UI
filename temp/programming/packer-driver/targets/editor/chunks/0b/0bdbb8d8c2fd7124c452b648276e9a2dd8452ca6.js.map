{"version":3,"sources":["file:///D:/ENGINES/Cocos/PROJECTS/103_2/387/ST/NEW/Rect/Turn_Rect_NEW_UI/assets/resources/scripts/UIManager.ts"],"names":["_decorator","Component","Node","Label","Vec3","tween","Color","Game","ccclass","property","UIManager","onNextLevelBtnClick","showState","gameNode","gameScript","getComponent","startNextLevel","console","error","start","showMessage","text","color","WHITE","stateLabel","string","node","active","setScale","to","scale","easing","stateName","layerMenu","layerGame","layerWindows","victoryWindow","playPopupAnim","winBase","getChildByPath"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label, Vec3, tween, Color } from 'cc';\r\nimport { Game } from \"./Game\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('UIManager')\r\nexport class UIManager extends Component {\r\n    // Твои реальные ноды из иерархии\r\n    @property(Node) public layerMenu: Node = null!;\r\n    @property(Node) public layerGame: Node = null!; // Тот самый HUD (Score/Timer)\r\n    @property(Node) public layerWindows: Node = null!;\r\n\r\n    // Ссылка на текст счета в окне победы\r\n    @property(Label) public finalScoreLabel: Label = null!;\r\n\r\n    @property(Label) public stateLabel: Label = null!; // Перетащи сюда ноду GameState из Layer_Game\r\n\r\n    @property(Node) public gameNode: Node = null!;\r\n\r\n    @property(Node) victoryWindow: Node = null!;\r\n\r\n\r\n    public onNextLevelBtnClick() {\r\n        // 1. Прячем окно победы\r\n        this.showState('GAME');\r\n\r\n        // 2. Вручную получаем доступ к скрипту Game через ноду\r\n        if (this.gameNode) {\r\n            const gameScript = this.gameNode.getComponent(Game);\r\n\r\n            if (gameScript) {\r\n                gameScript.startNextLevel();\r\n            } else {\r\n                console.error(\"Скрипт Game не найден на gameNode!\");\r\n            }\r\n        } else {\r\n            console.error(\"gameNode не назначена в инспекторе!\");\r\n        }\r\n    }\r\n\r\n    start() {\r\n        // Как только игра прогрузилась, говорим интерфейсу: \"Мы в игре!\"\r\n\r\n    }\r\n\r\n    // Метод для быстрых уведомлений (отсчет, штрафы)\r\n    public showMessage(text: string, color: Color = Color.WHITE) {\r\n        this.stateLabel.string = text;\r\n        this.stateLabel.color = color;\r\n        this.stateLabel.node.active = true;\r\n\r\n        // Анимация появления (пульсация)\r\n        this.stateLabel.node.setScale(new Vec3(0.5, 0.5, 1));\r\n        tween(this.stateLabel.node)\r\n            .to(0.2, { scale: new Vec3(1.2, 1.2, 1) }, { easing: 'backOut' })\r\n            .start();\r\n    }\r\n\r\n    // Метод для переключения состояний\r\n    // В твоем UIManager.ts\r\n    showState(stateName: string) {\r\n        // 1. Сначала выключаем всё\r\n        this.layerMenu.active = false;\r\n        this.layerGame.active = false;\r\n        this.layerWindows.active = false;\r\n\r\n        // 2. Включаем только то, что нужно\r\n        switch (stateName) {\r\n            case 'MENU':\r\n                this.layerMenu.active = true;\r\n                break;\r\n            case 'GAME':\r\n                this.layerGame.active = true;\r\n                break;\r\n            case 'VICTORY':\r\n                this.layerGame.active = true; // Игра остается видна на фоне\r\n                this.layerWindows.active = true;\r\n                // Здесь можно включить конкретно дочернее окно Victory\r\n               // this.layerWindows.getChildByName('VictoryWindow').active = true;\r\n                this.victoryWindow.active = true;\r\n                break;\r\n        }\r\n    }\r\n\r\n\r\n    private playPopupAnim() {\r\n        // Находим Window_Base внутри Victory_Root для анимации\r\n        const winBase = this.layerWindows.getChildByPath(\"Victory_Root/Window_Base\");\r\n        if (winBase) {\r\n            winBase.setScale(new Vec3(0.5, 0.5, 1));\r\n            tween(winBase)\r\n                .to(0.4, { scale: new Vec3(1, 1, 1) }, { easing: 'backOut' })\r\n                .start();\r\n        }\r\n    }\r\n}"]}